<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MacDocker</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        height: 100vh;
        background: url(../../day02/img/c7.webp) no-repeat center center/cover;
      }

      .docker {
        width: 100%;
        height: 120px;
        position: absolute;
        left: 50%;
        bottom: 3%;
        transform: translateX(-50%);
      }
      .menu {
        /* width: 600px; */
        height: 70px;
        /* padding-top: 10px; */
        border-radius: 10px;
        position: absolute;
        left: 50%;
        bottom: 3%;
        transform: translateX(-50%);
        background-color: rgba(255, 255, 255, 0.2);
        display: flex;
        /* justify-content: space-evenly; */
        align-items: flex-end;
        padding: 0 20px;
        cursor: pointer;
      }

      .menu-item {
        /* background-color: chocolate; */
        /* width: 50px; */
        /* height: 50px; */
        border-radius: 10px;
        width: calc(var(--i, 1) * 50px);
        height: calc(var(--i, 1) * 50px);
        margin-bottom: calc(var(--i, 1) * 10px);
      }
      .gap {
        /* width: 20px; */
        height: 50px;
        width: calc(var(--i, 1) * 20px);
      }
      .menu-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 10px;
      }
    </style>
  </head>
  <body>
    <div class="docker" id="docker">
      <div class="menu">
        <!-- <div class="gap-first"></div> -->
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <div class="gap"></div>
        <div class="menu-item">
          <img src="" alt="" />
        </div>
        <!-- <div class="gap-last"></div> -->
      </div>
    </div>
    <script type="module">
      import { createCurve } from "./Curve.js";
      // 你的模块化代码

      // 获取DOM元素
      const docker = document.getElementById("docker");
      const menu = document.querySelector(".menu");
      const items = menu.children;

      // 配置参数
      const range = 500; // 影响范围
      const maxScale = 1.5; // 最大缩放比例
      const minScale = 1; // 最小缩放比例

      // 布局函数 - 应用缩放效果
      function layout(curve) {
        for (const item of items) {
          // 获取每个项目的中心X坐标
          const rect = item.getBoundingClientRect();
          const x = rect.x + rect.width / 2;

          // 计算当前项目的缩放比例
          const scale = curve(x);

          // 设置自定义属性 --i
          item.style.setProperty("--i", scale);

          // 可选：如果 gap 也是单独的元素（如 <div class="gap"></div>），也可以设置
          const gap = item.nextElementSibling;
          if (gap && gap.classList.contains("gap")) {
            gap.style.setProperty("--i", scale);
          }
        }
      }

      // 鼠标移动事件 - 实时更新布局
      docker.onmousemove = function (e) {
        // 根据鼠标X坐标创建曲线函数
        // const curve = createCurve(range, e.clientX);
        const curve = createCurve(range, e.clientX, minScale, maxScale);
        // 应用布局
        layout(curve);
      };

      // 鼠标离开Dock区域时重置样式
      docker.onmouseleave = function (e) {
        for (const item of items) {
          // 重置缩放比例和下边距
          item.style.setProperty("--i", minScale * 1);
          item.style.marginBottom = "10";
        }
      };

      const img = [
        { name: "GTA3", url: "../image/GTA3.webp" },
        { name: "GAT罪恶都市", url: "../image/罪恶都市10周年.webp" },
        { name: "圣安地列斯", url: "../image/圣安地列斯.webp" },
        { name: "GTA4", url: "../image/GTA4.avif" },
        { name: "GTA5-1", url: "../image/GTA5-1.webp" },
        { name: "GTA6", url: "../image/GTA6.webp" },
        { name: "荒野大镖客2", url: "../image/荒野大镖客2.webp" },
        { name: "si", url: "../image/sifu.webp" },
        { name: "FC25", url: "../image/FC25.webp" },
        { name: "MC", url: "../image/MC.png" },
      ];

      const menuItems = document.querySelectorAll(".menu-item");
      menuItems.forEach((item, idx) => {
        const imgEl = item.querySelector("img");
        if (img[idx]) {
          imgEl.src = img[idx].url;
          imgEl.title = img[idx].name;
          // 可选：也可以设置alt属性
          imgEl.alt = img[idx].name;
        }
      });
    </script>
  </body>
</html>
